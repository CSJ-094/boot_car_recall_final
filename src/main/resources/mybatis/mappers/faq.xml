<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.boot.dao.FaqDAO">
    <resultMap id="faqResultMap" type="com.boot.dto.FaqDTO">
        <result property="faq_id" column="faqNo"/>
        <result property="category" column="faqCategory"/>
        <result property="question" column="faqTitle"/>
        <result property="answer" column="faqContent"/>
        <result property="created_at" column="created_at"/>
    </resultMap>

    <select id="listWithPaging" resultMap="faqResultMap">
        SELECT faqNo, faqCategory, faqTitle, faqContent, DATE_FORMAT(faqDate, '%Y-%m-%d') as created_at
        FROM tbl_faq
        ORDER BY faqNo DESC
        LIMIT #{amount} OFFSET #{offset}
    </select>

    <select id="getTotalCount" resultType="int">
        SELECT count(*) FROM tbl_faq
    </select>

    <select id="getFaq" resultMap="faqResultMap">
        SELECT faqNo, faqCategory, faqTitle, faqContent, DATE_FORMAT(faqDate, '%Y-%m-%d %H:%i') as created_at FROM tbl_faq WHERE faqNo = #{faq_id}
    </select>

    <insert id="write" useGeneratedKeys="true" keyProperty="faq_id">
        INSERT INTO tbl_faq (faqCategory, faqTitle, faqContent)
        VALUES (#{category}, #{question}, #{answer})
    </insert>

    <update id="modify">
        UPDATE tbl_faq SET faqCategory = #{category}, faqTitle = #{question}, faqContent = #{answer}, faqDate = CURRENT_TIMESTAMP WHERE faqNo = #{faq_id}
    </update>

    <delete id="delete">
        DELETE FROM tbl_faq WHERE faqNo = #{faq_id}
    </delete>
</mapper>
